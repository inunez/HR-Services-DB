<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:p="http://primefaces.org/ui"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
    xmlns:pe="http://primefaces.org/ui/extensions">

    <p:dialog header="Change of Employment Conditions" widgetVar="coecDialog" modal="true" appendTo="@(body)"
              closeOnEscape="true" draggable="false" resizable="false" showEffect="fade" id="coecDlg">
        <p:ajax event="close" listener="#{employeeController.cancelCOEC()}"/>
        
        <h:form id="formCOECDialog">
            <f:facet name="header">
                <p:messages id="messagesCOEC" showDetail="true" autoUpdate="true" />
            </f:facet>
            
            <c:set var="coec" value="#{employeeController.changeEmploymentCondition}"/>
            
            <!--EMPLOYEE DETAILS-->
            
            <h:panelGrid columns="1" style="margin-bottom:10px" cellpadding="5" id="viewCOEC">
                <p:panel class="employeeDetailsCOEC" header="Employee Details" >

                    <div class="firstColumnCoec">             
                        <h:outputText value="Employee Name:"/>
                    </div>
                    <div class="secondColumnCoec">
                        <h:outputText value="#{coec.employee.firstName} #{coec.employee.surname}" />
                    </div>
                    <div class="thirdColumnCoec">             
                        <h:outputText value="Employee ID: #{coec.employee.employeePK.idNumber}"/>
                    </div>

                    <div class="firstColumnCoec" style="border-bottom: none">             
                        <h:outputText value="Vaiation Type:"/>
                    </div>
                    <div class="secondColumnCoec" style="width: 78%; height: 33px; padding: 2px">
                        <p:selectOneRadio  id="coecVariationType" value="#{coec.coecVariationType}">
                            <f:selectItem itemLabel="Permanent" itemValue="PERMANENT"/>
                            <f:selectItem itemLabel="Secondment" itemValue="SECONDMENT" />
                            <f:selectItem itemLabel="HGD" itemValue="HGD" />
                        </p:selectOneRadio>
                    </div>

                    <div class="firstColumnCoec">             
                        <h:outputText value="Effective Date:"/>
                    </div>
                    <div class="secondColumnCoec" style="height: 25px; padding: 6px 2px">
                        <p:calendar id="effectiveDateCalendar" value="#{coec.effectiveDate}" showOn="button" required="true" 
                                    requiredMessage="Effective Date is mandatory" mode="popup" showButtonPanel="true" 
                                    size="12"/>
                    </div>
                    <div class="thirdColumnCoec" style="height: 25px; padding: 6px 2px">             
                        <h:outputText value="Secondment: "/> 
                        <p:calendar id="secondmentDateCalendar" value="#{coec.secondmentDate}" showOn="button" required="true" 
                                    requiredMessage="Secondment Date is mandatory" mode="popup" showButtonPanel="true" 
                                    size="12"/>
                    </div>
                </p:panel>
                <!--POSITION INFORMATION-->
                <p:panel class="positionDetailsCOEC" header="Position - Payroll and Costing Details" >
                    <table>
                        <thead>
                            <tr>
                                <th>Information</th>
                                <th>Current/Previous Details</th>
                                <th>Update Details to</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="width: 20%">
                                    <h:outputText value="Position Number:"/>
                                </td>
                                <td style="width: 35%">
                                    <h:outputText value="#{coec.employee.positionId.positionId}"/>
                                </td>
                                <td style="width: 35%">
                                    <p:selectOneMenu value="#{employeeController.changeEmploymentCondition.newPosition}" filter="true" filterMatchMode="contains"
                                                     height="100" style="width: 95%;">
                                        <f:selectItem itemLabel="Select..." itemValue=""/>
                                        <f:selectItems value="#{employeeController.listOfPositions}" var="position"
                                                       itemLabel="#{position.positionId} - #{position.positionTitle}" itemValue="#{position}"/>
                                    </p:selectOneMenu>
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 20%">
                                    <h:outputText value="Position Title:"/>
                                </td>
                                <td style="width: 35%">
                                    <h:outputText value="#{coec.employee.positionId.positionTitle}"/>
                                </td>
                                <td style="width: 35%">
                                    <h:outputText value="#{employeeController.changeEmploymentCondition.newPosition.positionTitle}"/>
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 20%">
                                    <h:outputText value="Facility/Service:"/>
                                </td>
                                <td style="width: 35%">
                                    <h:outputText value="#{coec.employee.payrollCollection[0].accountNumber.accountDescription}"/>
                                </td>
                                <td style="width: 35%">
                                    <p:selectOneMenu value="#{coec.newAccount}" filter="true" filterMatchMode="contains"
                                                     height="100" style="width: 95%;">
                                        <f:selectItem itemLabel="Select..." itemValue=""/>
                                        <f:selectItems value="#{employeeController.listOfAccounts}" var="account"
                                                       itemLabel="#{account.accountDescription}" itemValue="#{account}"/>
                                        <p:ajax event="change" listener="#{employeeController.accountChange()}" update="managerMenu"/>
                                    </p:selectOneMenu>
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 20%">
                                    <h:outputText value="Reports To:"/>
                                </td>
                                <td style="width: 35%">
                                    <h:outputText value="#{employeeController.reportsToList.size() eq 0 ? '' : 
                                           employeeController.reportsToList[0].firstName} #{employeeController.reportsToList[0].surname}"/>
                                </td>
                                <td style="width: 35%">
                                    <p:selectOneMenu value="#{coec.newManager}" filter="true" filterMatchMode="contains"
                                                     height="100" style="width: 95%;" id="managerMenu">
                                        <f:selectItem itemLabel="Select..." itemValue=""/>
                                        <f:selectItems value="#{employeeController.employeesByService}" var="manager"
                                                       itemLabel="#{manager.position.employeeCollection[0].firstName} #{manager.position.employeeCollection[0].surname}" itemValue="#{manager}"/>
                                    </p:selectOneMenu>
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 20%">
                                    <h:outputText value="Pay Classification:"/>
                                </td>
                                <td style="width: 35%">
                                    <h:outputText value="#{employeeController.payrollList[0].jobTitle.jobTitle} - 
                                                  #{employeeController.payrollList[0].jobTitle.jobTitleDescription}"/>
                                </td>
                                <td style="width: 35%">
                                    <p:selectOneMenu value="#{coec.newClassification}" filter="true" filterMatchMode="contains"
                                                     height="100" style="width: 95%;">
                                        <f:selectItem itemLabel="Select..." itemValue=""/>
                                        <f:selectItems value="#{employeeController.listOfClassifications}" var="classification"
                                                       itemLabel="#{classification.jobTitle} - #{classification.jobTitleDescription}" itemValue="#{classification}"/>
                                    </p:selectOneMenu>
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 20%">
                                    <h:outputText value="Salary/Hourly Rate:"/>
                                </td>
                                <td style="width: 35%">
                                    <h:outputText value="#{employeeController.payrollList[0].baseRate}"/>
                                </td>
                                <td style="width: 35%">
                                    <pe:inputNumber id="Input2" value="#{coec.newSalary}" symbol="$"/>
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 20%">
                                    <h:outputText value="Employment Type:"/>
                                </td>
                                <td style="width: 35%">
                                    <h:outputText value="#{employeeController.payrollList[0].employmentType.employmentTypeDescription}"/>
                                </td>
                                <td style="width: 35%">
                                    <p:selectOneRadio  id="coecEmploymentType" value="#{coec.newEmploymentType.employmentType}">
                                        <f:selectItem itemLabel="Casual" itemValue="C"/>
                                        <f:selectItem itemLabel="Part Time" itemValue="P" />
                                        <f:selectItem itemLabel="Full Time" itemValue="F" />
                                    </p:selectOneRadio>
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 20%">
                                    <h:outputText value="Employment Type:"/>
                                </td>
                                <td style="width: 35%">
                                    <h:outputText value="#{coec.employee.payrollCollection[0].awardCode.awardCode eq '1' ? 'Salaried' : 'EA Award'}"/>
                                </td>
                                <td style="width: 35%">
                                    <p:selectOneRadio  id="coecAwardType" value="#{coec.newAward}">
                                        <f:selectItem itemLabel="EA Award" itemValue="0"/>
                                        <f:selectItem itemLabel="Salaried" itemValue="1" />
                                    </p:selectOneRadio>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </p:panel>
                
                <h:panelGroup style="display:block; text-align:center">
                    <p:commandButton value="Back" id="backButton" icon="ui-icon-arrowreturnthick-1-w" 
                                     oncomplete="PF('coecDialog').hide()"
                                     process="@this @form"
                                     update="tabViewMain"
                                     actionListener="#{employeeController.cancelCOEC()}">
                    </p:commandButton>
                </h:panelGroup>
            </h:panelGrid>
        </h:form>   
    </p:dialog>

</ui:composition>